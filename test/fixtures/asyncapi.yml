asyncapi: 3.0.0
info:
  title: Comments Service
  version: 1.0.0
  description: This service is in charge of processing all the events related to comments.
servers:
  dev:
    host: test.mosquitto.org
    protocol: mqtt
channels:
  commentLiked:
    address: comment/liked
    messages:
      commentLiked:
        description: Message that is being sent when a comment has been liked by someone.
        payload:
          $ref: '#/components/schemas/commentReaction'
    description: Updates the likes count in the database when new like is noticed.
  commentUnliked:
    address: comment/unliked
    messages:
      commentUnliked:
        description: Message that is being sent when a comment has been unliked by someone.
        payload:
          $ref: '#/components/schemas/commentReaction'
    description: Updates the likes count in the database when comment is unliked.
  commentViews:
    address: comment/views
    messages:
      commentViews:
        description: >-
          Message that is being recived with the total number of views in a
          comment.
        payload:
          $ref: '#/components/schemas/commentCount'
    description: Gets the total number of comment views.
operations:
  commentLiked:
    action: send
    channel:
      $ref: '#/channels/commentLiked'
  commentUnliked:
    action: send
    channel:
      $ref: '#/channels/commentUnliked'
  commentViews:
    action: receive
    channel:
      $ref: '#/channels/commentViews'
components:
  schemas:
    commentCount:
      type: object
    additionalProperties: false
    properties:
      commentId:
        $ref: '#/components/schemas/commentId'
      count:
        type: integer
    commentReaction:
      type: object
      additionalProperties: false
      properties:
        commentId:
          $ref: '#/components/schemas/commentId'
    count:
      type: integer
    commentId:
      type: string