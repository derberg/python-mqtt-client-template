asyncapi: 2.6.0
info:
  title: Comments Service
  version: 1.0.0
  description: This service is in charge of processing all the events related to comments.

servers:
  dev:
    url: test.mosquitto.org
    protocol: mqtt

channels:
  comment/liked:
    description: Updates the likes count in the database when new like is noticed.
    publish: 
      message:
        description: Message that is being sent when a comment has been liked by someone.
        payload:
          $ref: '#/components/schemas/commentReaction'

  comment/unliked:
    description: Updates the likes count in the database when comment is unliked.
    publish: 
      operationId: commentUnliked
      message:
        description: Message that is being sent when a comment has been unliked by someone.
        payload:
          $ref: '#/components/schemas/commentReaction'

  comment/views:
    description: Gets the total number of comment views.
    subscribe: 
      operationId: commentViews
      message:
        description: Message that is being sent with the total number of views in a comment.
        payload:
          $ref: '#/components/schemas/commentCount'

components:
  schemas:
    commentCount:
      type: object
    additionalProperties: false
    properties:
        commentId:
          $ref: '#/components/schemas/commentId'
        count:
          $ref: '#/components/schemas/count'

    commentReaction:
      type: object
      additionalProperties: false
      properties:
        commentId:
          $ref: '#/components/schemas/commentId'
        
    count:        
      type: integer

    commentId:
      type: string